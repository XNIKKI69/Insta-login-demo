<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nova Social</title>
  <script type="module">
    // Import Firebase SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, collection, addDoc, getDocs, onSnapshot, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

    // âœ… Your Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyBoco0HmEDwL8ffXt5UJgWJgDyz2KghcFU",
      authDomain: "swordex-login.firebaseapp.com",
      databaseURL: "https://swordex-login-default-rtdb.firebaseio.com",
      projectId: "swordex-login",
      storageBucket: "swordex-login.firebasestorage.app",
      messagingSenderId: "633212760179",
      appId: "1:633212760179:web:ba64d2b8812ab5c134ba06"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();
    const db = getFirestore(app);
    const storage = getStorage(app);

    // Example: Google Login
    async function login() {
      try {
        await signInWithPopup(auth, provider);
      } catch (err) {
        console.error(err);
      }
    }

    // Example: Logout
    function logout() {
      signOut(auth);
    }

    // Realtime Auth Listener
    onAuthStateChanged(auth, (user) => {
      const status = document.getElementById("status");
      if (user) {
        status.innerText = `Welcome ${user.displayName}`;
      } else {
        status.innerText = "Not logged in";
      }
    });

    // Example: Create Post
    async function createPost() {
      const postInput = document.getElementById("postInput");
      if (postInput.value.trim() !== "") {
        await addDoc(collection(db, "posts"), {
          text: postInput.value,
          createdAt: serverTimestamp()
        });
        postInput.value = "";
      }
    }

    // Realtime Feed
    const q = query(collection(db, "posts"), orderBy("createdAt", "desc"));
    onSnapshot(q, (snapshot) => {
      const feed = document.getElementById("feed");
      feed.innerHTML = "";
      snapshot.forEach((doc) => {
        const div = document.createElement("div");
        div.textContent = doc.data().text;
        feed.appendChild(div);
      });
    });

    window.login = login;
    window.logout = logout;
    window.createPost = createPost;
  </script>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f4; }
    header { background: #333; color: #fff; padding: 1rem; text-align: center; }
    main { padding: 1rem; }
    #feed div { background: white; margin: 0.5rem 0; padding: 1rem; border-radius: 8px; }
    button { margin: 0.5rem; padding: 0.5rem 1rem; border: none; border-radius: 5px; cursor: pointer; }
    .btn-primary { background: #007bff; color: white; }
    .btn-danger { background: #dc3545; color: white; }
  </style>
</head>
<body>
  <header>
    <h1>Nova Social</h1>
    <p id="status">Not logged in</p>
    <button class="btn-primary" onclick="login()">Login with Google</button>
    <button class="btn-danger" onclick="logout()">Logout</button>
  </header>
  <main>
    <h2>Create Post</h2>
    <input id="postInput" type="text" placeholder="What's on your mind?" />
    <button class="btn-primary" onclick="createPost()">Post</button>
    <h2>Feed</h2>
    <div id="feed"></div>
  </main>
</body>
</html>
